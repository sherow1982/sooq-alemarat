<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Emirates Souq | Best Products & Exclusive Offers 2025</title>
  <meta name="description" content="Discover thousands of products at the best prices with fast shipping and cash on delivery across the UAE. Electronics, home appliances, fashion, and more." />
  <meta name="keywords" content="online shopping, UAE, electronics, home appliances, fashion, free shipping, cash on delivery" />
  
  <!-- SEO -->
  <link rel="canonical" href="https://sherow1982.github.io/sooq-alemarat/en/" />
  <link rel="alternate" hreflang="ar-AE" href="https://sherow1982.github.io/sooq-alemarat/" />
  <link rel="alternate" hreflang="en-AE" href="https://sherow1982.github.io/sooq-alemarat/en/" />
  
  <!-- Fonts - English Only -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" as="style" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />
  
  <!-- Theme -->
  <link rel="stylesheet" href="../css/improved-theme.css" />
  
  <style>
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      direction: ltr;
      text-align: left;
    }
    .hero-section, .section-title, .footer {
      text-align: left;
    }
    .logo img {
      margin-right: 12px;
      margin-left: 0;
    }
    .search-input::placeholder {
      text-align: left;
    }
    .category-card {
      transition: all 0.3s ease;
    }
    .category-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 30px rgba(212, 175, 55, 0.3);
    }
  </style>
</head>
<body class="ltr">
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="./" class="logo">
          <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/b1f430c1-8aa0-4082-8bec-59935fddfaa2.png" alt="Emirates Souq" style="height: 40px; margin-right: 12px;" />
          <span>Emirates Souq</span>
        </a>
        <nav>
          <ul class="nav-list">
            <li><a href="#categories">🏪 Categories</a></li>
            <li><a href="#featured">💎 Featured</a></li>
            <li><a href="../cart.html" target="_blank">🛒 Cart</a></li>
            <li><a href="../">العربية</a></li>
            <li><a href="../legal/terms.html" target="_blank">📋 Terms</a></li>
            <li><a href="../legal/privacy.html" target="_blank">🔒 Privacy</a></li>
            <li><a href="../legal/shipping.html" target="_blank">📦 Shipping</a></li>
            <li><a href="../legal/returns.html" target="_blank">↩️ Returns</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <!-- Hero -->
    <section class="hero-section">
      <div class="container">
        <h1 class="hero-title">🇦🇪 Welcome to Emirates Souq</h1>
        <p class="hero-description">
          Discover thousands of premium products with free shipping and cash on delivery across the United Arab Emirates.
        </p>
        <div class="search-box">
          <input type="search" id="en-search" class="search-input" placeholder="Search for products..." />
          <button class="search-btn" id="en-search-btn">🔍</button>
        </div>
      </div>
    </section>

    <!-- Categories -->
    <section id="categories" class="section">
      <div class="container">
        <h2 class="section-title">🏪 Shop by Category</h2>
        <div class="categories-grid" id="en-categories-container">
          <div class="loading">
            <div class="loading-spinner"></div>
            <h3>Loading categories...</h3>
          </div>
        </div>
      </div>
    </section>

    <!-- Products -->
    <section id="featured" class="section">
      <div class="container">
        <div class="tabs-nav">
          <button class="tab-btn active" data-tab="en-featured">💎 Premium Collection (AED 300+)</button>
          <button class="tab-btn" data-tab="en-all">🛑 All Products</button>
        </div>

        <div class="tab-content active" id="en-featured">
          <div class="products-grid" id="en-featured-container">
            <div class="loading">
              <div class="loading-spinner"></div>
              <h3>Loading premium collection...</h3>
            </div>
          </div>
        </div>

        <div class="tab-content" id="en-all">
          <div class="products-grid" id="en-all-container">
            <div class="loading">
              <div class="loading-spinner"></div>
              <h3>Loading all products...</h3>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>🏪 Emirates Souq</h3>
          <p>Leading digital shopping experience in the UAE</p>
          <p>100% UAE Product 🇦🇪</p>
        </div>
        <div class="footer-section">
          <h3>🔗 Important Links</h3>
          <div>
            <a href="../legal/terms.html" target="_blank" rel="noopener">📋 Terms</a><br />
            <a href="../legal/privacy.html" target="_blank" rel="noopener">🔒 Privacy</a><br />
            <a href="../legal/shipping.html" target="_blank" rel="noopener">📦 Shipping</a><br />
            <a href="../legal/returns.html" target="_blank" rel="noopener">↩️ Returns</a><br />
            <a href="../" rel="noopener">العربية</a>
          </div>
        </div>
        <div class="footer-section">
          <h3>📞 Contact</h3>
          <div>
            <a href="https://wa.me/201110760081" target="_blank" rel="noopener">📱 WhatsApp</a><br />
            <a href="tel:+201110760081">☎️ Call</a><br />
            <a href="../cart.html" target="_blank" rel="noopener">🛒 Cart</a><br />
            <a href="../checkout.html" target="_blank" rel="noopener">💳 Checkout</a>
          </div>
        </div>
        <div class="footer-section">
          <h3>✨ Our Services</h3>
          <div>
            🚚 Free Shipping<br />💰 Cash on Delivery<br />🔄 7-day Returns<br />⭐ 24/7 Support
          </div>
        </div>
      </div>
      <div style="border-top: 1px solid #666; padding-top: 1.5rem; margin-top: 1.5rem; text-align: left;">
        <p>&copy; 2025 Emirates Souq. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- WhatsApp Float -->
  <a href="https://wa.me/201110760081?text=Hello%2C%20I%20want%20to%20contact%20Emirates%20Souq%20team" 
     class="whatsapp-float" target="_blank" rel="noopener" title="WhatsApp">📱</a>

  <!-- Scripts -->
  <script src="../js/cart.js"></script>
  <script>
    // English Category Translation Map
    const CATEGORY_TRANSLATIONS = {
      'الأجهزة المنزلية والكهربائية': {
        en: 'Home Appliances & Electrical',
        icon: '🏠',
        slug: 'home-appliances-electrical'
      },
      'الإلكترونيات والتكنولوجيا': {
        en: 'Electronics & Technology', 
        icon: '📱',
        slug: 'electronics-technology'
      },
      'العناية الشخصية والصحة والجمال': {
        en: 'Personal Care, Health & Beauty',
        icon: '💄',
        slug: 'personal-care-health-beauty'
      },
      'الأحذية والملابس والإكسسوارات': {
        en: 'Shoes, Clothing & Accessories',
        icon: '👟',
        slug: 'shoes-clothing-accessories'
      },
      'الرياضة واللياقة والصحة': {
        en: 'Sports, Fitness & Health',
        icon: '🏅',
        slug: 'sports-fitness-health'
      },
      'الأثاث والأدوات المنزلية': {
        en: 'Furniture & Home Tools',
        icon: '🛋️',
        slug: 'furniture-home-tools'
      },
      'الأدوات والصيانة': {
        en: 'Tools & Maintenance',
        icon: '🔧',
        slug: 'tools-maintenance'
      },
      'منتجات متنوعة': {
        en: 'Miscellaneous Products',
        icon: '🛑',
        slug: 'miscellaneous-products'
      }
    };

    let allProductsData = [];

    // Load data and render English interface
    async function loadData() {
      try {
        console.log('📦 Loading product data for English site...');
        const response = await fetch('../data/uae-products.json');
        if (!response.ok) throw new Error(`HTTP ${response.status}: Failed to load data`);
        const data = await response.json();
        
        allProductsData = data;
        console.log('✅ Loaded', data.length, 'products for English site');
        
        renderEnglishCategories(data);
        renderEnglishProducts(data);
        
      } catch (error) {
        console.error('❌ Error loading data:', error);
        showError('Unable to load products. Please try again later.');
      }
    }

    function renderEnglishCategories(products) {
      const container = document.getElementById('en-categories-container');
      if (!container) return;
      
      // Count products per category
      const counts = {};
      products.forEach(p => {
        counts[p.category] = (counts[p.category] || 0) + 1;
      });
      
      // Sort by count desc
      const entries = Object.entries(counts).sort((a, b) => b[1] - a[1]);
      
      container.innerHTML = '';
      entries.forEach(([arabicName, count]) => {
        const categoryData = CATEGORY_TRANSLATIONS[arabicName];
        if (!categoryData) return;
        
        const card = document.createElement('div');
        card.className = 'category-card';
        card.setAttribute('data-category', arabicName);
        card.innerHTML = `
          <div class="category-icon">${categoryData.icon}</div>
          <h3 class="category-name">${categoryData.en}</h3>
          <div class="category-count">${count} products</div>
        `;
        
        // Open English category page with proper parameters
        card.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          const categoryUrl = `./category.html?name=${encodeURIComponent(arabicName)}&slug=${categoryData.slug}`;
          console.log(`🏪 Opening English category: ${categoryData.en} -> ${categoryUrl}`);
          
          window.open(categoryUrl, '_blank', 'noopener,noreferrer');
        });
        
        container.appendChild(card);
      });
      
      console.log('✅ Rendered', entries.length, 'English categories');
    }

    function renderEnglishProducts(data) {
      const featured = data.filter(p => (p.sale_price || p.regular_price) >= 300).slice(0, 12);
      const allProducts = data.sort((a, b) => (b.sale_price || b.regular_price || 0) - (a.sale_price || a.regular_price || 0)).slice(0, 24);
      
      const featuredContainer = document.getElementById('en-featured-container');
      const allContainer = document.getElementById('en-all-container');
      
      if (featuredContainer) {
        featuredContainer.innerHTML = featured.map(createEnglishProductCard).join('');
      }
      
      if (allContainer) {
        allContainer.innerHTML = allProducts.map(createEnglishProductCard).join('');
      }
      
      console.log(`✅ Rendered ${featured.length} featured + ${allProducts.length} all products`);
    }

    function createEnglishProductCard(product) {
      const currentPrice = product.sale_price || product.regular_price || 0;
      const originalPrice = product.sale_price && product.regular_price > product.sale_price 
        ? `<span class="original-price">${product.regular_price} AED</span>` 
        : '';
      const title = product.title.length > 60 ? product.title.slice(0, 60) + '…' : product.title;
      const categoryData = CATEGORY_TRANSLATIONS[product.category];
      const englishCategory = categoryData ? categoryData.en : product.category;
      
      const discountPercent = product.sale_price && product.regular_price > product.sale_price
        ? Math.round((1 - product.sale_price / product.regular_price) * 100)
        : 0;
      
      const whatsappMsg = `Hello, I'm interested in: ${product.title} (Price: ${currentPrice} AED)`;
      
      return `
        <div class="product-card" data-product-id="${product.id}">
          ${discountPercent > 0 ? `<div class="discount-badge">-${discountPercent}%</div>` : ''}
          
          <div class="product-image" onclick="openProduct('${product.id}')" style="cursor:pointer;">
            <img src="${product.image_url}" alt="${title}" loading="lazy" 
                 onerror="this.src='https://via.placeholder.com/400x300/1e40af/FFFFFF?text=Product'" />
          </div>
          
          <div class="product-info">
            <div class="product-category">${englishCategory}</div>
            <h3 class="product-title" onclick="openProduct('${product.id}')" style="cursor:pointer;">${title}</h3>
            
            <div class="product-rating">
              <span class="stars">⭐⭐⭐⭐⭐</span>
              <span class="rating-text">(4.8/5)</span>
            </div>
            
            <div class="product-price">
              <span class="current-price">${currentPrice} AED</span>
              ${originalPrice}
            </div>
            
            <div class="product-features">
              <div class="feature">🇦🇪 UAE Product</div>
              <div class="feature">🚚 Free Shipping</div>
              <div class="feature">💰 Cash on Delivery</div>
            </div>
            
            <div class="product-actions">
              <button class="btn add-to-cart" data-product-id="${product.id}" 
                      onclick="handleAddToCart('${product.id}', '${product.title.replace(/'/g, "\\'")}'', ${currentPrice}, '${product.image_url}')">
                🛒 Add to Cart
              </button>
              
              <a class="btn whatsapp-btn" href="https://wa.me/201110760081?text=${encodeURIComponent(whatsappMsg)}" 
                 target="_blank" rel="noopener">
                📱 WhatsApp
              </a>
              
              <button class="btn view-details" onclick="openProduct('${product.id}')">
                👁 View Details
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function openProduct(id) {
      const productUrl = `../product.html?id=${encodeURIComponent(id)}`;
      window.open(productUrl, '_blank', 'noopener,noreferrer');
    }

    function handleAddToCart(id, title, price, image) {
      try {
        console.log(`🛒 Adding to cart: ${title}`);
        
        // Use the global cart system if available
        if (window.cart && typeof window.cart.addToCart === 'function') {
          window.cart.addToCart(id, true); // true = open cart sidebar immediately
          return;
        }
        
        // Fallback: manual cart management
        const cartItems = JSON.parse(localStorage.getItem('emirates_cart') || '[]');
        const existingItem = cartItems.find(item => item.id === id);
        
        if (existingItem) {
          existingItem.quantity += 1;
          showNotification(`Increased quantity of "${title}" in cart!`);
        } else {
          cartItems.push({
            id: id,
            title: title,
            price: price,
            image: image,
            quantity: 1,
            addedAt: Date.now()
          });
          showNotification(`"${title}" added to cart successfully!`);
        }
        
        localStorage.setItem('emirates_cart', JSON.stringify(cartItems));
        
        // Try to open cart if available
        if (window.cart && typeof window.cart.openCart === 'function') {
          setTimeout(() => window.cart.openCart(), 300);
        }
        
      } catch (error) {
        console.error('Error adding to cart:', error);
        showNotification('Error adding product to cart', 'error');
      }
    }

    function showNotification(message, type = 'success') {
      document.querySelectorAll('.en-notification').forEach(n => n.remove());
      
      const colors = { 
        success: '#10b981', 
        error: '#ef4444',
        warning: '#f59e0b' 
      };
      
      const notification = document.createElement('div');
      notification.className = 'en-notification';
      notification.style.cssText = `
        position: fixed; top: 100px; right: 24px; 
        background: ${colors[type] || colors.success};
        color: white; padding: 1rem 1.5rem; border-radius: 15px;
        font-weight: 700; z-index: 10001; 
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        cursor: pointer; max-width: 350px; 
        border: 2px solid rgba(255, 255, 255, 0.3);
        font-family: 'Inter', sans-serif;
        animation: slideIn 0.4s ease;
      `;
      
      notification.textContent = message;
      notification.onclick = () => notification.remove();
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (notification.parentNode) {
          notification.style.animation = 'slideOut 0.4s ease forwards';
          setTimeout(() => notification.remove(), 400);
        }
      }, 4000);
    }

    function showError(message) {
      const container = document.getElementById('en-categories-container');
      if (container) {
        container.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">⚠️</div>
            <h3>${message}</h3>
            <a href="../" style="
              display: inline-block; margin-top: 1rem; padding: 1rem 2rem; 
              background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; text-decoration: none; 
              border-radius: 12px; font-weight: 600;
            ">🏠 Back to Home</a>
          </div>
        `;
      }
    }

    // Search functionality
    function performSearch() {
      const query = (document.getElementById('en-search').value || '').trim();
      if (!query || query.length < 2) {
        showNotification('Please enter at least 2 characters to search', 'warning');
        return;
      }
      
      console.log('🔍 Searching for:', query);
      // For now, redirect to all products tab
      document.querySelector('[data-tab="en-all"]').click();
      showNotification(`Searching for: ${query}`);
    }

    // Initialize tabs
    function setupTabs() {
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          btn.classList.add('active');
          document.getElementById(btn.dataset.tab).classList.add('active');
        });
      });
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      console.log('✅ Emirates Souq English - Initializing...');
      setupTabs();
      loadData();
      
      // Search events
      const searchBtn = document.getElementById('en-search-btn');
      const searchInput = document.getElementById('en-search');
      
      if (searchBtn) searchBtn.addEventListener('click', performSearch);
      if (searchInput) {
        searchInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') performSearch();
        });
      }
    });
    
    // Animation styles
    if (!document.getElementById('en-animations')) {
      const animStyles = document.createElement('style');
      animStyles.id = 'en-animations';
      animStyles.textContent = `
        @keyframes slideIn {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOut {
          from { transform: translateX(0); opacity: 1; }
          to { transform: translateX(100%); opacity: 0; }
        }
      `;
      document.head.appendChild(animStyles);
    }
  </script>
</body>
</html>